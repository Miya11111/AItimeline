# 国際化 (i18n) 設定

このプロジェクトの多言語対応システムのドキュメントです。

## 概要

`i18n-js`を使用した型安全な翻訳システムです。各画面やコンポーネントで定義した翻訳は自動的に収集され、統合されます。

## ファイル構成

```
i18n/
├── index.ts                    # i18n設定ファイル
├── collect-translations.ts     # 翻訳自動収集スクリプト
└── locales/
    ├── index.ts                # ロケールファイルのエクスポート
    ├── ja.ts                   # 日本語翻訳（共通 + 自動収集）
    └── en.ts                   # 英語翻訳（共通 + 自動収集）

hooks/
└── use-translation.ts          # 翻訳用フック
```

## 基本的な使用方法

### 1. コンポーネントで翻訳を定義する

各コンポーネントファイル内で`*Ja`と`*En`をエクスポートします：

```typescript
// app/(tabs)/index.tsx
export const HomeJa = {
  welcome: 'こんにちは',
  title: 'ホーム',
};

export const HomeEn = {
  welcome: 'welcome',
  title: 'Home',
};

function HomeScreen() {
  const t = useTranslation();
  return <Text>{t('home.welcome')}</Text>;
}
```

**重要**:

- エクスポート名は`*Ja`と`*En`の形式にする（例: `HomeJa`, `HomeEn`）
- `*`の部分（例: `Home`）が小文字化されて翻訳キーのプレフィックスになる（`home.welcome`）

### 2. 翻訳を自動収集に登録する

`i18n/collect-translations.ts`にインポートを追加：

```typescript
// i18n/collect-translations.ts

// Home screen translations
import { HomeJa, HomeEn } from '@/app/(tabs)/index';

// 新しい画面を追加する場合
import { ProfileJa, ProfileEn } from '@/app/(tabs)/profile';

const translations = {
  HomeJa,
  HomeEn,
  ProfileJa, // 追加
  ProfileEn, // 追加
};
```

### 3. コンポーネントで翻訳を使用する

```typescript
import { useTranslation } from '@/hooks/use-translation';

function MyComponent() {
  const t = useTranslation();

  return (
    <View>
      <Text>{t('home.welcome')}</Text>
      <Text>{t('profile.name')}</Text>
    </View>
  );
}
```

## 翻訳キーの命名規則

エクスポート名から翻訳キーが自動生成されます：

```typescript
// エクスポート名 → 翻訳キープレフィックス
HomeJa     → home.*
ProfileJa  → profile.*
SettingsJa → settings.*
AuthJa     → auth.*
```

**例**:

```typescript
export const AuthJa = {
  login: 'ログイン',
  logout: 'ログアウト',
};

// 使用
t('auth.login'); // => "ログイン"
t('auth.logout'); // => "ログアウト"
```

## 共通翻訳

頻繁に使用する翻訳は`i18n/locales/ja.ts`と`en.ts`の`common`セクションに追加します：

```typescript
// i18n/locales/ja.ts
export const ja = {
  common: {
    ok: 'OK',
    cancel: 'キャンセル',
    save: '保存',
  },
  // 自動収集された翻訳がここにマージされる
  ...collectedJa,
};
```

使用例：

```typescript
t('common.ok'); // => "OK"
t('common.cancel'); // => "キャンセル"
```

## 新しい画面の翻訳を追加する手順

1. **コンポーネントファイルで翻訳を定義**

```typescript
// app/(tabs)/profile.tsx
export const ProfileJa = {
  name: '名前',
  email: 'メールアドレス',
  save: '保存する',
};

export const ProfileEn = {
  name: 'Name',
  email: 'Email',
  save: 'Save',
};
```

2. **collect-translations.tsに登録**

```typescript
// i18n/collect-translations.ts
import { HomeJa, HomeEn } from '@/app/(tabs)/index';
import { ProfileJa, ProfileEn } from '@/app/(tabs)/profile'; // 追加

const translations = {
  HomeJa,
  HomeEn,
  ProfileJa, // 追加
  ProfileEn, // 追加
};
```

3. **コンポーネントで使用**

```typescript
function ProfileScreen() {
  const t = useTranslation();
  return <Text>{t('profile.name')}</Text>;
}
```

## 型安全性

すべての翻訳キーはTypeScriptで型チェックされます：

```typescript
const t = useTranslation();

// ✅ OK - 存在するキー
const text1 = t('home.welcome');
const text2 = t('common.ok');

// ❌ コンパイルエラー - 存在しないキー
const text3 = t('home.invalidKey');
```

## 変数を含む翻訳

```typescript
// 定義
export const ProfileJa = {
  greeting: 'こんにちは、{{name}}さん！',
};

// 使用
t('profile.greeting', { name: '太郎' }); // => "こんにちは、太郎さん！"
```

## トラブルシューティング

### 型エラーが出る

1. `collect-translations.ts`に翻訳をインポートしたか確認
2. `translations`オブジェクトに追加したか確認
3. IDEを再起動してTypeScriptサーバーをリフレッシュ

### 翻訳が表示されない

1. `*Ja`と`*En`の両方をエクスポートしているか確認
2. `collect-translations.ts`にインポートされているか確認
3. アプリを再起動

## ベストプラクティス

### ✅ 良い例

```typescript
// 画面ごとに翻訳を定義
export const HomeJa = {
  welcome: 'ようこそ',
  subtitle: 'ホーム画面',
};

export const HomeEn = {
  welcome: 'Welcome',
  subtitle: 'Home Screen',
};

// collect-translations.tsに登録
// コンポーネントでuseTranslationを使用
const t = useTranslation();
```

### ❌ 悪い例

```typescript
// i18n/locales/ja.tsに直接書く（推奨されない）
export const ja = {
  home: {
    welcome: 'ようこそ', // 個別画面の翻訳は各ファイルで定義する
  },
};

// 翻訳をハードコード
const text = 'ようこそ'; // 翻訳を使うべき
```

## 参考リンク

- [i18n-js公式ドキュメント](https://github.com/fnando/i18n-js)
- [expo-localization](https://docs.expo.dev/versions/latest/sdk/localization/)
